SELECT TOP 1 PERSON_NAME FROM (
    SELECT 
    *,
    SUM(WEIGHT) OVER (ORDER BY TURN) AS S
FROM 
    QUEUE) AS TEMP
WHERE 
	S <=1000
ORDER BY 
	S DESC